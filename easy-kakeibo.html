<!DOCTYPE html>

<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>簡単家計簿</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: white;
        }

         /* タイトル中央揃え */
    h1 {
      text-align: center;
    }

    /* 入力フォーム・合計のデザイン */
    .form, .summary, .list {
      background: white;            /* 背景を白に */
      border: 1px solid #ccc;       /* 薄いグレーの枠線 */
      padding: 20px;                /* 内側の余白 */
      margin-bottom: 20px;          /* 下にスペースを空ける */
      border-radius: 8px;           /* 角を丸くする */
    }

    /* 入力欄・ボタンの共通スタイル */
    input, select, button {
      padding: 10px;                /* 中の余白 */
      margin: 5px 0;                /* 上下の間隔 */
      width: 100%;                  /* 横幅いっぱいに表示 */
      box-sizing: border-box;       /* padding を含めて width を計算し、見た目を崩れにくくする */
    }

/* 追加ボタンのスタイル */
    button {
      background-color: #28a745;    /* 緑っぽい背景色（成功イメージ） */
      color: white;                 /* 文字を白 */
      border: none;                 /* 枠なし */
      cursor: pointer;              /* ホバー時にポインター表示 */
    }

    /* 各記録のスタイル */
    .item {
      border-bottom: 1px solid #eee; /* 下線で区切る */
      padding: 10px 0;               /* 上下に余白 */
    }

    .item:last-child {
      border-bottom: none;          /* 最後のアイテムだけ下線なし */
    }
  </style>
</head>

<body>

  <!-- タイトル -->
  <h1>初心者向け家計簿</h1>

  <!-- 入力フォーム部分 -->
  <div class="form">
    <h2>記録を追加</h2>
    <input type="text" id="name" placeholder="内容（例：スーパー）"> <!-- 内容入力欄 -->
    <input type="number" id="money" placeholder="金額（例：500）"> <!-- 金額入力欄 -->
    <select id="type"> <!-- 収入か支出を選ぶ -->
      <option value="out">支出</option>
      <option value="in">収入</option>
    </select>
    <button onclick="add()">追加する</button> <!-- JavaScript関数 add() を呼ぶ -->
  </div>

  <!-- 合計の表示 -->
  <div class="summary">
    <h2>合計</h2>
    <p>収入: ¥<span id="total-in">0</span></p>
    <p>支出: ¥<span id="total-out">0</span></p>
  </div>

  <!-- 記録一覧の表示 -->
  <div class="list" id="list">
    <h2>記録一覧</h2>
    <!-- JavaScriptでここに記録が追加される -->
  </div>

  <!-- JavaScript部分（動きのある処理） -->
  <script>
    // 収入・支出の合計を保存する変数
    let totalIn = 0;
    let totalOut = 0;

    // 記録の一覧（オブジェクトの配列）を保持する変数
    let records = [];

    // ページが読み込まれたときにローカルストレージから記録を復元する
    window.onload = function () {
      const data = localStorage.getItem("kakeibo-records"); // 保存されているデータを取得
      if (data) {
        records = JSON.parse(data); // JSON文字列 → 配列に変換
        document.getElementById("list").innerHTML = ""; // 一度リストを空に
        records.forEach(record => displayItem(record)); // 1件ずつ表示
        updateTotals(); // 合計を再計算
      }
    }

    // 追加ボタンが押されたときに呼ばれる関数
    function add() {
      // フォームから値を取得
      const name = document.getElementById("name").value.trim();
      const money = parseInt(document.getElementById("money").value);
      const type = document.getElementById("type").value;
      const date = new Date().toLocaleDateString(); // 今日の日付を取得

      // 入力チェック
      if (!name || isNaN(money) || money <= 0) {
        alert("内容と正しい金額を入力してください。");
        return;
      }

      // 新しい記録を作成
      const record = { name, money, type, date };

      // 配列に追加
      records.push(record);

      // データ保存・表示・合計更新
      saveToLocalStorage();
      displayItem(record);
      updateTotals();

      // 入力欄をリセット
      document.getElementById("name").value = "";
      document.getElementById("money").value = "";
    }

    // 記録を画面に表示する関数
    function displayItem(record) {
      const list = document.getElementById("list");
      const div = document.createElement("div");
      div.className = "item";
      // 「日付 - 内容：¥金額（収入 or 支出）」の形式で表示
      div.textContent = `${record.date} - ${record.name}：¥${record.money}（${record.type === "in" ? "収入" : "支出"}）`;
      list.appendChild(div);
    }

    // 合計を更新する関数
    function updateTotals() {
      totalIn = 0;
      totalOut = 0;
      // 配列内のデータを集計
      records.forEach(r => {
        if (r.type === "in") {
          totalIn += r.money;
        } else {
          totalOut += r.money;
        }
      });

      // HTMLに反映
      document.getElementById("total-in").textContent = totalIn;
      document.getElementById("total-out").textContent = totalOut;
    }

    // ローカルストレージに保存する関数
    function saveToLocalStorage() {
      localStorage.setItem("kakeibo-records", JSON.stringify(records));
    }
  </script>
</body>
</html>
